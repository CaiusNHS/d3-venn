!function(r,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.venn=n():r.venn=n()}(self,(function(){return(()=>{"use strict";var r={d:(n,t)=>{for(var e in t)r.o(t,e)&&!r.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})},o:(r,n)=>Object.prototype.hasOwnProperty.call(r,n),r:r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},n={};function t(r,n){return function(t){return arguments.length?(this[r]=t,n):this[r]}}function e(r,n){for(var t in n)r[t]&&"function"==typeof r[t]&&r[t](n[t]);return r}function a(r,n){for(var e in n)r[e]||(r[e]=t(e,r).bind(n))}r.r(n),r.d(n,{distribute:()=>v,force:()=>p,pack:()=>g,venn:()=>K});const i=1e-10;function s(r,n){var t,e=function(r){for(var n=[],t=0;t<r.length;++t)for(var e=t+1;e<r.length;++e)for(var a=c(r[t],r[e]),i=0;i<a.length;++i){var s=a[i];s.parentIndex=[t,e],n.push(s)}return n}(r),a=e.filter((function(n){return o(n,r)})),s=0,u=0,x=[];if(a.length>1){var y=l(a);for(t=0;t<a.length;++t){var g=a[t];g.angle=Math.atan2(g.x-y.x,g.y-y.y)}a.sort((function(r,n){return n.angle-r.angle}));var v=a[a.length-1];for(t=0;t<a.length;++t){var p=a[t];u+=(v.x+p.x)*(p.y-v.y);for(var d={x:(p.x+v.x)/2,y:(p.y+v.y)/2},m=null,M=0;M<p.parentIndex.length;++M)if(v.parentIndex.indexOf(p.parentIndex[M])>-1){var z=r[p.parentIndex[M]],R=Math.atan2(p.x-z.x,p.y-z.y),_=Math.atan2(v.x-z.x,v.y-z.y),b=_-R;b<0&&(b+=2*Math.PI);var I=_-b/2,P=h(d,{x:z.x+z.radius*Math.sin(I),y:z.y+z.radius*Math.cos(I)});(null===m||m.width>P)&&(m={circle:z,width:P,p1:p,p2:v})}x.push(m),s+=f(m.circle.radius,m.width),v=p}}else{var w=r[0];for(t=1;t<r.length;++t)r[t].radius<w.radius&&(w=r[t]);var k=!1;for(t=0;t<r.length;++t)if(h(r[t],w)>Math.abs(w.radius-r[t].radius)){k=!0;break}k?s=u=0:(s=w.radius*w.radius*Math.PI,x.push({circle:w,p1:{x:w.x,y:w.y+w.radius},p2:{x:w.x-i,y:w.y+w.radius},width:2*w.radius}))}return u/=2,n&&(n.area=s+u,n.arcArea=s,n.polygonArea=u,n.arcs=x,n.innerPoints=a,n.intersectionPoints=e),s+u}function o(r,n){for(var t=0;t<n.length;++t)if(h(r,n[t])>n[t].radius+i)return!1;return!0}function u(r,n){var t=Math.sqrt(r*r-n*n);return n*t+r*r*Math.atan2(n,t)}function f(r,n){return u(r,n-r)-u(r,-r)}function h(r,n){return Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y))}function x(r,n,t){if(t>=r+n)return 0;if(t<=Math.abs(r-n))return Math.PI*Math.min(r,n)*Math.min(r,n);var e=n-(t*t-r*r+n*n)/(2*t);return f(r,r-(t*t-n*n+r*r)/(2*t))+f(n,e)}function c(r,n){var t=h(r,n),e=r.radius,a=n.radius;if(t>=e+a||t<=Math.abs(e-a))return[];var i=(e*e-a*a+t*t)/(2*t),s=Math.sqrt(e*e-i*i),o=r.x+i*(n.x-r.x)/t,u=r.y+i*(n.y-r.y)/t,f=-(n.y-r.y)*(s/t),x=-(n.x-r.x)*(s/t);return[{x:o+f,y:u-x},{x:o-f,y:u+x}]}function l(r){for(var n={x:0,y:0},t=0;t<r.length;++t)n.x+=r[t].x,n.y+=r[t].y;return n.x/=r.length,n.y/=r.length,n}function y(r,n){for(var t=0;t<n.length;++t)if(h(r,n[t])<n[t].radius+i)return!1;return!0}function g(r){var n=r.packingConfig();r.sets().forEach((function(r,t){var a=t.innerRadius,i=t.center,s=t.nodes,o=i.x-a,u=i.y-a;e(d3.layout.pack(),n).size([2*a,2*a]).nodes({children:s}),s&&s.forEach((function(r){r.x+=o,r.y+=u}))}))}function v(r){var n=r.circles();r.sets().forEach((function(r,t){var e=[],a=[],i=[],s=t.center,u=t.innerRadius;for(r in n)t.sets.indexOf(r)>-1?a.push(n[r]):i.push(n[r]);t.nodes.map((function(r,n){var t=0,f=null;if(0==n)r.x=s.x,r.y=s.y,e.push(r);else{for(;!f&&t<500;){n=Math.random()*e.length|0;var h=e[n],x=2*Math.PI*Math.random(),c=Math.sqrt(Math.random()*(u*u+100)),l={x:h.x+c*Math.cos(x),y:h.y+c*Math.sin(x)};t++,o(l,a)&&y(l,i)&&(f=l,e.push(l))}f||(console.warn("NO CANDIDATE"),f={x:s.x,y:s.y}),r.x=f.x,r.y=f.y}}))}))}function p(r,n){var t=r.packer();t||a(t=d3.layout.force(),{padding:3,maxRadius:8,collider:!0,ticker:null,ender:null,starter:null});var i,s=r.packingConfig(),o=r.size(),u=r.sets(),f=t.padding(),h=t.maxRadius(),x=t.collider;return e(t,s).nodes(n).links([]).gravity(0).charge(0).size(o).on("start",(function(e){var a;n.forEach((function(r){var n=u.get(r.__setKey__).center;r.x=r.x?1*r.x:n.x,r.y=r.y?1*r.y:n.y})),(a=t.starter())&&a(r)})).on("tick",(function(e){var a,i;n.forEach(function(r){return function(n){var t=u.get(n.__setKey__).center;n.y+=(t.y-n.y)*r,n.x+=(t.x-n.x)*r}}(.2*e.alpha)),x&&n.forEach((.5,i=d3.geom.quadtree(n),function(r){var n=r.r+h+f,t=r.x-n,e=r.x+n,a=r.y-n,s=r.y+n;i.visit((function(n,i,o,u,h){if(n.point&&n.point!==r){var x=r.x-n.point.x,c=r.y-n.point.y,l=Math.sqrt(x*x+c*c),y=r.r+n.point.r+(r.__setKey__!==n.point.__setKey__)*f;l<y&&(l=(l-y)/l*.5,r.x-=x*=l,r.y-=c*=l,n.point.x+=x,n.point.y+=c)}return i>e||u<t||o>s||h<a}))})),(a=t.ticker())&&a(r)})),(i=t.ender())&&t.on("end",i),t}function d(r){for(var n=new Array(r),t=0;t<r;++t)n[t]=0;return n}function m(r,n){return d(r).map((function(){return d(n)}))}function M(r,n){for(var t=0,e=0;e<r.length;++e)t+=r[e]*n[e];return t}function z(r){return Math.sqrt(M(r,r))}function R(r,n){for(var t=0;t<r.length;++t)r[t]*=n}function _(r,n,t,e,a){for(var i=0;i<r.length;++i)r[i]=n*t[i]+e*a[i]}function b(r,n,t){var e,a=(t=t||{}).maxIterations||200*n.length,i=t.nonZeroDelta||1.1,s=t.zeroDelta||.001,o=t.minErrorDelta||1e-6,u=t.rho||1,f=t.chi||2,h=t.psi||-.5,x=t.sigma||.5,c=t.callback,l=n.length,y=new Array(l+1);y[0]=n,y[0].fx=r(n);for(var g=0;g<l;++g){var v=n.slice();v[g]=v[g]?v[g]*i:s,y[g+1]=v,y[g+1].fx=r(v)}for(var p=function(r,n){return r.fx-n.fx},d=n.slice(),m=n.slice(),M=n.slice(),z=n.slice(),R=0;R<a&&(y.sort(p),c&&c(y),!(Math.abs(y[0].fx-y[l].fx)<o));++R){for(g=0;g<l;++g){d[g]=0;for(var b=0;b<l;++b)d[g]+=y[b][g];d[g]/=l}var I=y[l];if(_(m,1+u,d,-u,I),m.fx=r(m),m.fx<=y[0].fx)_(z,1+f,d,-f,I),z.fx=r(z),z.fx<m.fx?(e=y[l],y[l]=z,z=e):(e=y[l],y[l]=m,m=e);else if(m.fx>=y[l-1].fx){var P=!1;if(m.fx<=I.fx?(_(M,1+h,d,-h,I),M.fx=r(M),M.fx<I.fx?(e=y[l],y[l]=M,M=e):P=!0):(_(M,1-h*u,d,h*u,I),M.fx=r(M),M.fx<=m.fx?(e=y[l],y[l]=M,M=e):P=!0),P)for(g=1;g<y.length;++g)_(y[g],1-x,y[0],x-1,y[g]),y[g].fx=r(y[g])}else e=y[l],y[l]=m,m=e}return y.sort(p),{f:y[0].fx,solution:y[0]}}function I(r,n,t){var e,a,i,s={x:n.slice(),fx:0,fxprime:n.slice()},o={x:n.slice(),fx:0,fxprime:n.slice()},u=n.slice(),f=1;i=(t=t||{}).maxIterations||5*n.length,s.fx=r(s.x,s.fxprime),R(e=s.fxprime.slice(),-1);for(var h=0;h<i;++h){if(t.history&&t.history.push({x:s.x.slice(),fx:s.fx,fxprime:s.fxprime.slice()}),f=w(r,e,s,o,f)){_(u,1,o.fxprime,-1,s.fxprime);var x=M(s.fxprime,s.fxprime);_(e,Math.max(0,M(u,o.fxprime)/x),e,-1,o.fxprime),a=s,s=o,o=a}else for(var c=0;c<e.length;++c)e[c]=-1*s.fxprime[c];if(z(s.fxprime)<=1e-5)break}return t.history&&t.history.push({x:s.x.slice(),fx:s.fx,fxprime:s.fxprime.slice()}),s}var P=1e-6;function w(r,n,t,e,a){var i=t.fx,s=M(t.fxprime,n),o=i,u=i,f=s,h=0;function x(u,h,x){for(var c=0;c<16;++c)if(a=(u+h)/2,_(e.x,1,t.x,a,n),o=e.fx=r(e.x,e.fxprime),f=M(e.fxprime,n),o>i+P*a*s||o>=x)h=a;else{if(Math.abs(f)<=-.1*s)return a;f*(h-u)>=0&&(h=u),u=a,x=o}return 0}a=a||1;for(var c=0;c<10;++c){if(_(e.x,1,t.x,a,n),o=e.fx=r(e.x,e.fxprime),f=M(e.fxprime,n),o>i+P*a*s||c&&o>=u)return x(h,a,u);if(Math.abs(f)<=-.1*s)return a;if(f>=0)return x(a,h,o);u=o,h=a,a*=2}return 0}function k(r,n){(n=n||{}).maxIterations=n.maxIterations||500;var t,e=n.lossFunction||j,a=n.initialLayout||E,i=n.fmin||b,s=a(r=function(r){r=r.slice();var n,t,e,a,i=[],s={};for(n=0;n<r.length;++n){var o=r[n];1==o.sets.length?i.push(o.sets[0]):2==o.sets.length&&(s[[e=o.sets[0],a=o.sets[1]]]=!0,s[[a,e]]=!0)}for(i.sort((function(r,n){return r>n})),n=0;n<i.length;++n)for(e=i[n],t=n+1;t<i.length;++t)[e,a=i[t]]in s||r.push({sets:[e,a],size:0});return r}(r)),o=[],u=[];for(t in s)s.hasOwnProperty(t)&&(o.push(s[t].x),o.push(s[t].y),u.push(t));for(var f=i((function(n){for(var t={},a=0;a<u.length;++a){var i=u[a];t[i]={x:n[2*a],y:n[2*a+1],radius:s[i].radius}}return e(t,r)}),o,n).solution,h=0;h<u.length;++h)t=u[h],s[t].x=f[2*h],s[t].y=f[2*h+1];return s}function O(r,n,t){return Math.min(r,n)*Math.min(r,n)*Math.PI<=t+i?Math.abs(r-n):function(r,n,t,e){var a=(e=e||{}).maxIterations||100,i=e.tolerance||1e-10,s=r(n),o=r(t),u=t-n;if(s*o>0)throw"Initial bisect points must have opposite signs";if(0===s)return n;if(0===o)return t;for(var f=0;f<a;++f){var h=n+(u/=2),x=r(h);if(x*s>=0&&(n=h),Math.abs(u)<i||0===x)return h}return n+u}((function(e){return x(r,n,e)-t}),0,r+n)}function E(r,n){var t=function(r){for(var n,t={},e={},a=0;a<r.length;++a){var s=r[a];1==s.sets.length&&(n=s.sets[0],t[n]={x:1e10,y:1e10,rowid:t.length,size:s.size,radius:Math.sqrt(s.size/Math.PI)},e[n]=[])}for(r=r.filter((function(r){return 2==r.sets.length})),a=0;a<r.length;++a){var o=r[a],u=o.hasOwnProperty("weight")?o.weight:1,f=o.sets[0],h=o.sets[1];o.size+i>=Math.min(t[f].size,t[h].size)&&(u=0),e[f].push({set:h,size:o.size,weight:u}),e[h].push({set:f,size:o.size,weight:u})}var x=[];for(n in e)if(e.hasOwnProperty(n)){var l=0;for(a=0;a<e[n].length;++a)l+=e[n][a].size*e[n][a].weight;x.push({set:n,size:l})}function y(r,n){return n.size-r.size}x.sort(y);var g={};function v(r){return r.set in g}function p(r,n){t[n].x=r.x,t[n].y=r.y,g[n]=!0}for(p({x:0,y:0},x[0].set),a=1;a<x.length;++a){var d=x[a].set,m=e[d].filter(v);if(n=t[d],m.sort(y),0===m.length)throw"ERROR: missing pairwise overlap information";for(var M=[],z=0;z<m.length;++z){var R=t[m[z].set],_=O(n.radius,R.radius,m[z].size);M.push({x:R.x+_,y:R.y}),M.push({x:R.x-_,y:R.y}),M.push({y:R.y+_,x:R.x}),M.push({y:R.y-_,x:R.x});for(var b=z+1;b<m.length;++b)for(var I=t[m[b].set],P=O(n.radius,I.radius,m[b].size),w=c({x:R.x,y:R.y,radius:_},{x:I.x,y:I.y,radius:P}),k=0;k<w.length;++k)M.push(w[k])}var E=1e50,q=M[0];for(z=0;z<M.length;++z){t[d].x=M[z].x,t[d].y=M[z].y;var A=j(t,r);A<E&&(E=A,q=M[z])}p(q,d)}return t}(r);if(r.length>=8){var e=function(r,n){var t,e=(n=n||{}).restarts||10,a=[],i={};for(t=0;t<r.length;++t){var s=r[t];1==s.sets.length&&(i[s.sets[0]]=a.length,a.push(s))}var o=function(r,n,t){var e=m(n.length,n.length),a=m(n.length,n.length);return r.filter((function(r){return 2==r.sets.length})).map((function(r){var i=t[r.sets[0]],s=t[r.sets[1]],o=O(Math.sqrt(n[i].size/Math.PI),Math.sqrt(n[s].size/Math.PI),r.size);e[i][s]=e[s][i]=o;var u=0;r.size+1e-10>=Math.min(n[i].size,n[s].size)?u=1:r.size<=1e-10&&(u=-1),a[i][s]=a[s][i]=u})),{distances:e,constraints:a}}(r,a,i),u=o.distances,f=o.constraints,h=z(u.map(z))/u.length;u=u.map((function(r){return r.map((function(r){return r/h}))}));var x,c,l=function(r,n){return function(r,n,t,e){var a,i=0;for(a=0;a<n.length;++a)n[a]=0;for(a=0;a<t.length;++a)for(var s=r[2*a],o=r[2*a+1],u=a+1;u<t.length;++u){var f=r[2*u],h=r[2*u+1],x=t[a][u],c=e[a][u],l=(f-s)*(f-s)+(h-o)*(h-o),y=Math.sqrt(l),g=l-x*x;c>0&&y<=x||c<0&&y>=x||(i+=2*g*g,n[2*a]+=4*g*(s-f),n[2*a+1]+=4*g*(o-h),n[2*u]+=4*g*(f-s),n[2*u+1]+=4*g*(h-o))}return i}(r,n,u,f)};for(t=0;t<e;++t)c=I(l,d(2*u.length).map(Math.random),n),(!x||c.fx<x.fx)&&(x=c);var y=x.x,g={};for(t=0;t<a.length;++t){var v=a[t];g[v.sets[0]]={x:y[2*t]*h,y:y[2*t+1]*h,radius:Math.sqrt(v.size/Math.PI)}}if(n.history)for(t=0;t<n.history.length;++t)R(n.history[t].x,h);return g}(r,n);j(e,r)+1e-8<j(t,r)&&(t=e)}return t}function j(r,n){for(var t=0,e=0;e<n.length;++e){var a,i=n[e];if(1!=i.sets.length){if(2==i.sets.length){var o=r[i.sets[0]],u=r[i.sets[1]];a=x(o.radius,u.radius,h(o,u))}else a=s(i.sets.map((function(n){return r[n]})));t+=(i.hasOwnProperty("weight")?i.weight:1)*(a-i.size)*(a-i.size)}}return t}function q(r,n){var t;if(r.sort((function(r,n){return n.radius-r.radius})),r.length>0){var e=r[0].x,a=r[0].y;for(t=0;t<r.length;++t)r[t].x-=e,r[t].y-=a}if(r.length>1){var i,s,o=Math.atan2(r[1].x,r[1].y)-n,u=Math.cos(o),f=Math.sin(o);for(t=0;t<r.length;++t)i=r[t].x,s=r[t].y,r[t].x=u*i-f*s,r[t].y=f*i+u*s}if(r.length>2){for(var h=Math.atan2(r[2].x,r[2].y)-n;h<0;)h+=2*Math.PI;for(;h>2*Math.PI;)h-=2*Math.PI;if(h>Math.PI){var x=r[1].y/(1e-10+r[1].x);for(t=0;t<r.length;++t){var c=(r[t].x+x*r[t].y)/(1+x*x);r[t].x=2*c-r[t].x,r[t].y=2*c*x-r[t].y}}}}function A(r){var n=function(n){return{max:Math.max.apply(null,r.map((function(r){return r[n]+r.radius}))),min:Math.min.apply(null,r.map((function(r){return r[n]-r.radius})))}};return{xRange:n("x"),yRange:n("y")}}function S(r,n,t){var e,a,i=n[0].radius-h(n[0],r);for(e=1;e<n.length;++e)(a=n[e].radius-h(n[e],r))<=i&&(i=a);for(e=0;e<t.length;++e)(a=h(t[e],r)-t[e].radius)<=i&&(i=a);return i}function C(r,n){var t,e=[];for(t=0;t<r.length;++t){var a=r[t];e.push({x:a.x,y:a.y}),e.push({x:a.x+a.radius/2,y:a.y}),e.push({x:a.x-a.radius/2,y:a.y}),e.push({x:a.x,y:a.y+a.radius/2}),e.push({x:a.x,y:a.y-a.radius/2})}var i=e[0],o=S(e[0],r,n);for(t=1;t<e.length;++t){var u=S(e[t],r,n);u>=o&&(i=e[t],o=u)}var f=b((function(t){return-1*S({x:t[0],y:t[1]},r,n)}),[i.x,i.y],{maxIterations:500,minErrorDelta:1e-10}).solution,x={x:f[0],y:f[1]},c=!0;for(t=0;t<r.length;++t)if(h(x,r[t])>r[t].radius){c=!1;break}for(t=0;t<n.length;++t)if(h(x,n[t])<n[t].radius){c=!1;break}if(!c)if(1==r.length)x={x:r[0].x,y:r[0].y};else{var y={};s(r,y),x=0===y.arcs.length?{x:0,y:-1e3,disjoint:!0}:1==y.arcs.length?{x:y.arcs[0].circle.x,y:y.arcs[0].circle.y}:n.length?C(r,[]):l(y.arcs.map((function(r){return r.p1})))}return x}function D(r,n){for(var t={},e=function(r){var n={},t=[];for(var e in r)t.push(e),n[e]=[];for(var a=0;a<t.length;a++)for(var i=r[t[a]],s=a+1;s<t.length;++s){var o=r[t[s]],u=h(i,o);u+o.radius<=i.radius+1e-10?n[t[s]].push(t[a]):u+i.radius<=o.radius+1e-10&&n[t[a]].push(t[s])}return n}(r),a=0;a<n.length;++a){for(var i=n[a].sets,s={},o={},u=0;u<i.length;++u){s[i[u]]=!0;for(var f=e[i[u]],x=0;x<f.length;++x)o[f[x]]=!0}var c=[],l=[];for(var y in r)y in s?c.push(r[y]):y in o||l.push(r[y]);var g=C(c,l);t[i]=g,g.disjoint&&n[a].size>0&&console.log("WARNING: area "+i+" not represented on screen")}return t}function K(){var r,n,t,i,o={sets:null,setsAccessor:function(r){return r.set||[]},setsSize:function(r){return r},packingStragegy:g,packingConfig:{value:function(r){return r.value}},size:[1,1],padding:0,layoutFunction:k,orientation:Math.PI/2,normalize:!0};function u(r){return arguments.length?(n=f(r),u):n}function f(n){var e,a,o,f=u.sets(),x=u.layoutFunction(),c=u.packingStragegy(),l=u.size(),y=l[0],g=l[1];for(var v in a=x(e=(f=function(r){var n,t,e,a,i=d3.map({},(function(r){return r.__key__})),s=d3.map(),o=u.setsAccessor(),f=u.setsSize(),h=r.length;for(a=-1;++a<h;)(n=o(r[a])).length&&(e=n.sort().join(","),n.forEach((function(r){(t=s.get(r))?t.size+=1:s.set(r,{__key__:r,size:1,sets:[r],nodes:[]})})),r[a].__setKey__=e,(t=i.get(e))?(t.size++,t.nodes.push(r[a])):i.set(e,{__key__:e,sets:n,size:1,nodes:[r[a]]}));return s.forEach((function(r,n){i.get(r)||i.set(r,n)})),i.forEach((function(r,n){n.size=f(n.size)})),u.sets(i),i}(n)).values()),console.info("data: ",n),console.info("sets: ",f),u.normalize()&&(a=function(r,n){n=n||Math.PI/2;var t,e,a=[];for(e in r)if(r.hasOwnProperty(e)){var i=r[e];a.push({x:i.x,y:i.y,radius:i.radius,setid:e})}var s=function(r){function n(r){return r.parent!==r&&(r.parent=n(r.parent)),r.parent}r.map((function(r){r.parent=r}));for(var t=0;t<r.length;++t)for(var e=t+1;e<r.length;++e){var a=r[t].radius+r[e].radius;h(r[t],r[e])+1e-10<a&&(i=r[e],s=r[t],o=void 0,o=n(i),u=n(s),o.parent=u)}var i,s,o,u,f,x={};for(t=0;t<r.length;++t)(f=n(r[t]).parent.setid)in x||(x[f]=[]),x[f].push(r[t]);r.map((function(r){delete r.parent}));var c=[];for(f in x)x.hasOwnProperty(f)&&c.push(x[f]);return c}(a);for(t=0;t<s.length;++t){q(s[t],n);var o=A(s[t]);s[t].size=(o.xRange.max-o.xRange.min)*(o.yRange.max-o.yRange.min),s[t].bounds=o}s.sort((function(r,n){return n.size-r.size}));var u=(a=s[0]).bounds,f=(u.xRange.max-u.xRange.min)/50;function x(r,n,t){if(r){var e,i,s,o=r.bounds;n?e=u.xRange.max-o.xRange.min+f:(e=u.xRange.max-o.xRange.max-f,(s=(o.xRange.max-o.xRange.min)/2-(u.xRange.max-u.xRange.min)/2)<0&&(e+=s)),t?i=u.yRange.max-o.yRange.min+f:(i=u.yRange.max-o.yRange.max-f,(s=(o.yRange.max-o.yRange.min)/2-(u.yRange.max-u.yRange.min)/2)<0&&(i+=s));for(var h=0;h<r.length;++h)r[h].x+=e,r[h].y+=i,a.push(r[h])}}for(var c=1;c<s.length;)x(s[c],!0,!1),x(s[c+1],!1,!0),x(s[c+2],!0,!0),c+=3,u=A(a);var l={};for(t=0;t<a.length;++t)l[a[t].setid]=a[t];return l}(a,u.orientation())),o=r,r=function(r,n,t,e){var a=[],i=[];for(var s in r)r.hasOwnProperty(s)&&(i.push(s),a.push(r[s]));n-=2*e,t-=2*e;for(var o=A(a),u=o.xRange,f=o.yRange,h=n/(u.max-u.min),x=t/(f.max-f.min),c=Math.min(x,h),l=(n-(u.max-u.min)*c)/2,y=(t-(f.max-f.min)*c)/2,g={},v=0;v<a.length;++v){var p=a[v];g[i[v]]={radius:c*p.radius,x:e+l+(p.x-u.min)*c,y:e+y+(p.y-f.min)*c}}return g}(a,y,g,u.padding()),o)r[v]&&(r[v].previous=o[v]);function p(n,t){for(var e,a=0,i=n.length;a<i;a++)if(h(e=r[n[a]],t)<e.radius)return!0;return!1}return o=null,i=D(r,e),f.forEach((function(n,t){t.d=function(n){return function(t){return function(r){var n={};s(r,n);var t=n.arcs;if(0===t.length)return"M 0 0";if(1==t.length){var e=t[0].circle;return function(r,n,t){var e=[];return e.push("\nM",r,n),e.push("\nm",-t,0),e.push("\na",t,t,0,1,0,2*t,0),e.push("\na",t,t,0,1,0,2*-t,0),e.join(" ")}(e.x,e.y,e.radius)}for(var a=["\nM",t[0].p2.x,t[0].p2.y],i=0;i<t.length;++i){var o=t[i],u=o.circle.radius,f=o.width>u;a.push("\nA",u,u,0,f?1:0,1,o.p1.x,o.p1.y)}return a.join(" ")}(n.sets.map((function(n){var e=r[n],a=e&&e.previous,i=e;return a||(a={x:y/2,y:g/2,radius:1}),i||(i={x:y/2,y:g/2,radius:1}),1==t&&e&&(e.previous=i),{x:a.x*(1-t)+i.x*t,y:a.y*(1-t)+i.y*t,radius:a.radius*(1-t)+i.radius*t}})))}}(t),t.center=i[n],t.innerRadius=function(n){var t,e,a,i,s,o=n.sets,u=n.center,f=1/0;for(t in r)e=r[t],i=o.indexOf(t)>-1,s=o.indexOf(t)<-1&&p(o,e),a=h(u,e),(a=i?e.radius-a:s?a-e.radius:a+e.radius)<f&&(f=a);return f}(t)})),t=c(u,n),n}return a(u,o),u.packingConfig=function(r){var n=o.packingConfig;if(!arguments.length)return n;for(var a in r)n[a]=r[a];return t&&e(t,r),u},u.packer=function(){return t},u.circles=function(){return r},u.centres=function(){return i},u.nodes=u,u}return n})()}));