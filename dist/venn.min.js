// https://github.com/christophe-g/d3-venn v1.0.1 Copyright 2021 Caius Eugene
!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((r="undefined"!=typeof globalThis?globalThis:r||self).d3=r.d3||{})}(this,(function(r){"use strict";function n(r,n){return function(t){return arguments.length?(this[r]=t,n):this[r]}}function t(r,n){for(var t in n)r[t]&&"function"==typeof r[t]&&r[t](n[t]);return r}function e(r,t){for(var e in t)r[e]||(r[e]=n(e,r).bind(t))}const a=1e-10;function i(r,n){var t,e=function(r){for(var n=[],t=0;t<r.length;++t)for(var e=t+1;e<r.length;++e)for(var a=x(r[t],r[e]),i=0;i<a.length;++i){var s=a[i];s.parentIndex=[t,e],n.push(s)}return n}(r),i=e.filter((function(n){return s(n,r)})),u=0,h=0,l=[];if(i.length>1){var y=c(i);for(t=0;t<i.length;++t){var g=i[t];g.angle=Math.atan2(g.x-y.x,g.y-y.y)}i.sort((function(r,n){return n.angle-r.angle}));var v=i[i.length-1];for(t=0;t<i.length;++t){var p=i[t];h+=(v.x+p.x)*(p.y-v.y);for(var d={x:(p.x+v.x)/2,y:(p.y+v.y)/2},m=null,M=0;M<p.parentIndex.length;++M)if(v.parentIndex.indexOf(p.parentIndex[M])>-1){var z=r[p.parentIndex[M]],R=Math.atan2(p.x-z.x,p.y-z.y),_=Math.atan2(v.x-z.x,v.y-z.y),I=_-R;I<0&&(I+=2*Math.PI);var w=_-I/2,P=f(d,{x:z.x+z.radius*Math.sin(w),y:z.y+z.radius*Math.cos(w)});(null===m||m.width>P)&&(m={circle:z,width:P,p1:p,p2:v})}l.push(m),u+=o(m.circle.radius,m.width),v=p}}else{var b=r[0];for(t=1;t<r.length;++t)r[t].radius<b.radius&&(b=r[t]);var k=!1;for(t=0;t<r.length;++t)if(f(r[t],b)>Math.abs(b.radius-r[t].radius)){k=!0;break}k?u=h=0:(u=b.radius*b.radius*Math.PI,l.push({circle:b,p1:{x:b.x,y:b.y+b.radius},p2:{x:b.x-a,y:b.y+b.radius},width:2*b.radius}))}return h/=2,n&&(n.area=u+h,n.arcArea=u,n.polygonArea=h,n.arcs=l,n.innerPoints=i,n.intersectionPoints=e),u+h}function s(r,n){for(var t=0;t<n.length;++t)if(f(r,n[t])>n[t].radius+a)return!1;return!0}function u(r,n){var t=Math.sqrt(r*r-n*n);return n*t+r*r*Math.atan2(n,t)}function o(r,n){return u(r,n-r)-u(r,-r)}function f(r,n){return Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y))}function h(r,n,t){if(t>=r+n)return 0;if(t<=Math.abs(r-n))return Math.PI*Math.min(r,n)*Math.min(r,n);var e=n-(t*t-r*r+n*n)/(2*t);return o(r,r-(t*t-n*n+r*r)/(2*t))+o(n,e)}function x(r,n){var t=f(r,n),e=r.radius,a=n.radius;if(t>=e+a||t<=Math.abs(e-a))return[];var i=(e*e-a*a+t*t)/(2*t),s=Math.sqrt(e*e-i*i),u=r.x+i*(n.x-r.x)/t,o=r.y+i*(n.y-r.y)/t,h=-(n.y-r.y)*(s/t),x=-(n.x-r.x)*(s/t);return[{x:u+h,y:o-x},{x:u-h,y:o+x}]}function c(r){for(var n={x:0,y:0},t=0;t<r.length;++t)n.x+=r[t].x,n.y+=r[t].y;return n.x/=r.length,n.y/=r.length,n}function l(r,n){for(var t=0;t<n.length;++t)if(f(r,n[t])<n[t].radius+a)return!1;return!0}function y(r){var n=r.packingConfig();r.sets().forEach((function(r,e){var a=e.innerRadius,i=e.center,s=e.nodes,u=i.x-a,o=i.y-a;t(d3.layout.pack(),n).size([2*a,2*a]).nodes({children:s}),s&&s.forEach((function(r){r.x+=u,r.y+=o}))}))}function g(r){for(var n=new Array(r),t=0;t<r;++t)n[t]=0;return n}function v(r,n){return g(r).map((function(){return g(n)}))}function p(r,n){for(var t=0,e=0;e<r.length;++e)t+=r[e]*n[e];return t}function d(r){return Math.sqrt(p(r,r))}function m(r,n){for(var t=0;t<r.length;++t)r[t]*=n}function M(r,n,t,e,a){for(var i=0;i<r.length;++i)r[i]=n*t[i]+e*a[i]}function z(r,n,t){var e,a=(t=t||{}).maxIterations||200*n.length,i=t.nonZeroDelta||1.1,s=t.zeroDelta||.001,u=t.minErrorDelta||1e-6,o=t.rho||1,f=t.chi||2,h=t.psi||-.5,x=t.sigma||.5,c=t.callback,l=n.length,y=new Array(l+1);y[0]=n,y[0].fx=r(n);for(var g=0;g<l;++g){var v=n.slice();v[g]=v[g]?v[g]*i:s,y[g+1]=v,y[g+1].fx=r(v)}for(var p=function(r,n){return r.fx-n.fx},d=n.slice(),m=n.slice(),z=n.slice(),R=n.slice(),_=0;_<a&&(y.sort(p),c&&c(y),!(Math.abs(y[0].fx-y[l].fx)<u));++_){for(g=0;g<l;++g){d[g]=0;for(var I=0;I<l;++I)d[g]+=y[I][g];d[g]/=l}var w=y[l];if(M(m,1+o,d,-o,w),m.fx=r(m),m.fx<=y[0].fx)M(R,1+f,d,-f,w),R.fx=r(R),R.fx<m.fx?(e=y[l],y[l]=R,R=e):(e=y[l],y[l]=m,m=e);else if(m.fx>=y[l-1].fx){var P=!1;if(m.fx<=w.fx?(M(z,1+h,d,-h,w),z.fx=r(z),z.fx<w.fx?(e=y[l],y[l]=z,z=e):P=!0):(M(z,1-h*o,d,h*o,w),z.fx=r(z),z.fx<=m.fx?(e=y[l],y[l]=z,z=e):P=!0),P)for(g=1;g<y.length;++g)M(y[g],1-x,y[0],x-1,y[g]),y[g].fx=r(y[g])}else e=y[l],y[l]=m,m=e}return y.sort(p),{f:y[0].fx,solution:y[0]}}function R(r,n,t){var e,a,i,s={x:n.slice(),fx:0,fxprime:n.slice()},u={x:n.slice(),fx:0,fxprime:n.slice()},o=n.slice(),f=1;i=(t=t||{}).maxIterations||5*n.length,s.fx=r(s.x,s.fxprime),m(e=s.fxprime.slice(),-1);for(var h=0;h<i;++h){if(t.history&&t.history.push({x:s.x.slice(),fx:s.fx,fxprime:s.fxprime.slice()}),f=I(r,e,s,u,f)){M(o,1,u.fxprime,-1,s.fxprime);var x=p(s.fxprime,s.fxprime);M(e,Math.max(0,p(o,u.fxprime)/x),e,-1,u.fxprime),a=s,s=u,u=a}else for(var c=0;c<e.length;++c)e[c]=-1*s.fxprime[c];if(d(s.fxprime)<=1e-5)break}return t.history&&t.history.push({x:s.x.slice(),fx:s.fx,fxprime:s.fxprime.slice()}),s}var _=1e-6;function I(r,n,t,e,a){var i=t.fx,s=p(t.fxprime,n),u=i,o=i,f=s,h=0;function x(o,h,x){for(var c=0;c<16;++c)if(a=(o+h)/2,M(e.x,1,t.x,a,n),u=e.fx=r(e.x,e.fxprime),f=p(e.fxprime,n),u>i+_*a*s||u>=x)h=a;else{if(Math.abs(f)<=-.1*s)return a;f*(h-o)>=0&&(h=o),o=a,x=u}return 0}a=a||1;for(var c=0;c<10;++c){if(M(e.x,1,t.x,a,n),u=e.fx=r(e.x,e.fxprime),f=p(e.fxprime,n),u>i+_*a*s||c&&u>=o)return x(h,a,o);if(Math.abs(f)<=-.1*s)return a;if(f>=0)return x(a,h,u);o=u,h=a,a*=2}return 0}function w(r,n){(n=n||{}).maxIterations=n.maxIterations||500;var t,e=n.lossFunction||k,a=n.initialLayout||b,i=n.fmin||z,s=a(r=function(r){r=r.slice();var n,t,e,a,i=[],s={};for(n=0;n<r.length;++n){var u=r[n];1==u.sets.length?i.push(u.sets[0]):2==u.sets.length&&(s[[e=u.sets[0],a=u.sets[1]]]=!0,s[[a,e]]=!0)}for(i.sort((function(r,n){return r>n})),n=0;n<i.length;++n)for(e=i[n],t=n+1;t<i.length;++t)[e,a=i[t]]in s||r.push({sets:[e,a],size:0});return r}(r)),u=[],o=[];for(t in s)s.hasOwnProperty(t)&&(u.push(s[t].x),u.push(s[t].y),o.push(t));for(var f=i((function(n){for(var t={},a=0;a<o.length;++a){var i=o[a];t[i]={x:n[2*a],y:n[2*a+1],radius:s[i].radius}}return e(t,r)}),u,n).solution,h=0;h<o.length;++h)t=o[h],s[t].x=f[2*h],s[t].y=f[2*h+1];return s}function P(r,n,t){return Math.min(r,n)*Math.min(r,n)*Math.PI<=t+a?Math.abs(r-n):function(r,n,t,e){var a=(e=e||{}).maxIterations||100,i=e.tolerance||1e-10,s=r(n),u=r(t),o=t-n;if(s*u>0)throw"Initial bisect points must have opposite signs";if(0===s)return n;if(0===u)return t;for(var f=0;f<a;++f){var h=n+(o/=2),x=r(h);if(x*s>=0&&(n=h),Math.abs(o)<i||0===x)return h}return n+o}((function(e){return h(r,n,e)-t}),0,r+n)}function b(r,n){var t=function(r){for(var n,t={},e={},i=0;i<r.length;++i){var s=r[i];1==s.sets.length&&(n=s.sets[0],t[n]={x:1e10,y:1e10,rowid:t.length,size:s.size,radius:Math.sqrt(s.size/Math.PI)},e[n]=[])}for(r=r.filter((function(r){return 2==r.sets.length})),i=0;i<r.length;++i){var u=r[i],o=u.hasOwnProperty("weight")?u.weight:1,f=u.sets[0],h=u.sets[1];u.size+a>=Math.min(t[f].size,t[h].size)&&(o=0),e[f].push({set:h,size:u.size,weight:o}),e[h].push({set:f,size:u.size,weight:o})}var c=[];for(n in e)if(e.hasOwnProperty(n)){var l=0;for(i=0;i<e[n].length;++i)l+=e[n][i].size*e[n][i].weight;c.push({set:n,size:l})}function y(r,n){return n.size-r.size}c.sort(y);var g={};function v(r){return r.set in g}function p(r,n){t[n].x=r.x,t[n].y=r.y,g[n]=!0}for(p({x:0,y:0},c[0].set),i=1;i<c.length;++i){var d=c[i].set,m=e[d].filter(v);if(n=t[d],m.sort(y),0===m.length)throw"ERROR: missing pairwise overlap information";for(var M=[],z=0;z<m.length;++z){var R=t[m[z].set],_=P(n.radius,R.radius,m[z].size);M.push({x:R.x+_,y:R.y}),M.push({x:R.x-_,y:R.y}),M.push({y:R.y+_,x:R.x}),M.push({y:R.y-_,x:R.x});for(var I=z+1;I<m.length;++I)for(var w=t[m[I].set],b=P(n.radius,w.radius,m[I].size),E=x({x:R.x,y:R.y,radius:_},{x:w.x,y:w.y,radius:b}),O=0;O<E.length;++O)M.push(E[O])}var q=1e50,A=M[0];for(z=0;z<M.length;++z){t[d].x=M[z].x,t[d].y=M[z].y;var j=k(t,r);j<q&&(q=j,A=M[z])}p(A,d)}return t}(r);if(r.length>=8){var e=function(r,n){var t,e=(n=n||{}).restarts||10,a=[],i={};for(t=0;t<r.length;++t){var s=r[t];1==s.sets.length&&(i[s.sets[0]]=a.length,a.push(s))}var u=function(r,n,t){var e=v(n.length,n.length),a=v(n.length,n.length);return r.filter((function(r){return 2==r.sets.length})).map((function(r){var i=t[r.sets[0]],s=t[r.sets[1]],u=P(Math.sqrt(n[i].size/Math.PI),Math.sqrt(n[s].size/Math.PI),r.size);e[i][s]=e[s][i]=u;var o=0;r.size+1e-10>=Math.min(n[i].size,n[s].size)?o=1:r.size<=1e-10&&(o=-1),a[i][s]=a[s][i]=o})),{distances:e,constraints:a}}(r,a,i),o=u.distances,f=u.constraints,h=d(o.map(d))/o.length;o=o.map((function(r){return r.map((function(r){return r/h}))}));var x,c,l=function(r,n){return function(r,n,t,e){var a,i=0;for(a=0;a<n.length;++a)n[a]=0;for(a=0;a<t.length;++a)for(var s=r[2*a],u=r[2*a+1],o=a+1;o<t.length;++o){var f=r[2*o],h=r[2*o+1],x=t[a][o],c=e[a][o],l=(f-s)*(f-s)+(h-u)*(h-u),y=Math.sqrt(l),g=l-x*x;c>0&&y<=x||c<0&&y>=x||(i+=2*g*g,n[2*a]+=4*g*(s-f),n[2*a+1]+=4*g*(u-h),n[2*o]+=4*g*(f-s),n[2*o+1]+=4*g*(h-u))}return i}(r,n,o,f)};for(t=0;t<e;++t){c=R(l,g(2*o.length).map(Math.random),n),(!x||c.fx<x.fx)&&(x=c)}var y=x.x,p={};for(t=0;t<a.length;++t){var M=a[t];p[M.sets[0]]={x:y[2*t]*h,y:y[2*t+1]*h,radius:Math.sqrt(M.size/Math.PI)}}if(n.history)for(t=0;t<n.history.length;++t)m(n.history[t].x,h);return p}(r,n);k(e,r)+1e-8<k(t,r)&&(t=e)}return t}function k(r,n){var t=0;for(var e=0;e<n.length;++e){var a,s=n[e];if(1!=s.sets.length){if(2==s.sets.length){var u=r[s.sets[0]],o=r[s.sets[1]];a=h(u.radius,o.radius,f(u,o))}else a=i(s.sets.map((function(n){return r[n]})));t+=(s.hasOwnProperty("weight")?s.weight:1)*(a-s.size)*(a-s.size)}}return t}function E(r,n){var t;if(r.sort((function(r,n){return n.radius-r.radius})),r.length>0){var e=r[0].x,a=r[0].y;for(t=0;t<r.length;++t)r[t].x-=e,r[t].y-=a}if(r.length>1){var i,s,u=Math.atan2(r[1].x,r[1].y)-n,o=Math.cos(u),f=Math.sin(u);for(t=0;t<r.length;++t)i=r[t].x,s=r[t].y,r[t].x=o*i-f*s,r[t].y=f*i+o*s}if(r.length>2){for(var h=Math.atan2(r[2].x,r[2].y)-n;h<0;)h+=2*Math.PI;for(;h>2*Math.PI;)h-=2*Math.PI;if(h>Math.PI){var x=r[1].y/(1e-10+r[1].x);for(t=0;t<r.length;++t){var c=(r[t].x+x*r[t].y)/(1+x*x);r[t].x=2*c-r[t].x,r[t].y=2*c*x-r[t].y}}}}function O(r){var n=function(n){return{max:Math.max.apply(null,r.map((function(r){return r[n]+r.radius}))),min:Math.min.apply(null,r.map((function(r){return r[n]-r.radius})))}};return{xRange:n("x"),yRange:n("y")}}function q(r,n){n=n||Math.PI/2;var t,e,a=[];for(e in r)if(r.hasOwnProperty(e)){var i=r[e];a.push({x:i.x,y:i.y,radius:i.radius,setid:e})}var s=function(r){function n(r){return r.parent!==r&&(r.parent=n(r.parent)),r.parent}r.map((function(r){r.parent=r}));for(var t=0;t<r.length;++t)for(var e=t+1;e<r.length;++e){var a=r[t].radius+r[e].radius;f(r[t],r[e])+1e-10<a&&(i=r[e],s=r[t],u=void 0,o=void 0,u=n(i),o=n(s),u.parent=o)}var i,s,u,o,h,x={};for(t=0;t<r.length;++t)(h=n(r[t]).parent.setid)in x||(x[h]=[]),x[h].push(r[t]);r.map((function(r){delete r.parent}));var c=[];for(h in x)x.hasOwnProperty(h)&&c.push(x[h]);return c}(a);for(t=0;t<s.length;++t){E(s[t],n);var u=O(s[t]);s[t].size=(u.xRange.max-u.xRange.min)*(u.yRange.max-u.yRange.min),s[t].bounds=u}s.sort((function(r,n){return n.size-r.size}));var o=(a=s[0]).bounds,h=(o.xRange.max-o.xRange.min)/50;function x(r,n,t){if(r){var e,i,s,u=r.bounds;n?e=o.xRange.max-u.xRange.min+h:(e=o.xRange.max-u.xRange.max-h,(s=(u.xRange.max-u.xRange.min)/2-(o.xRange.max-o.xRange.min)/2)<0&&(e+=s)),t?i=o.yRange.max-u.yRange.min+h:(i=o.yRange.max-u.yRange.max-h,(s=(u.yRange.max-u.yRange.min)/2-(o.yRange.max-o.yRange.min)/2)<0&&(i+=s));for(var f=0;f<r.length;++f)r[f].x+=e,r[f].y+=i,a.push(r[f])}}for(var c=1;c<s.length;)x(s[c],!0,!1),x(s[c+1],!1,!0),x(s[c+2],!0,!0),c+=3,o=O(a);var l={};for(t=0;t<a.length;++t)l[a[t].setid]=a[t];return l}function A(r,n,t){var e,a,i=n[0].radius-f(n[0],r);for(e=1;e<n.length;++e)(a=n[e].radius-f(n[e],r))<=i&&(i=a);for(e=0;e<t.length;++e)(a=f(t[e],r)-t[e].radius)<=i&&(i=a);return i}function j(r,n){var t,e=[];for(t=0;t<r.length;++t){var a=r[t];e.push({x:a.x,y:a.y}),e.push({x:a.x+a.radius/2,y:a.y}),e.push({x:a.x-a.radius/2,y:a.y}),e.push({x:a.x,y:a.y+a.radius/2}),e.push({x:a.x,y:a.y-a.radius/2})}var s=e[0],u=A(e[0],r,n);for(t=1;t<e.length;++t){var o=A(e[t],r,n);o>=u&&(s=e[t],u=o)}var h=z((function(t){return-1*A({x:t[0],y:t[1]},r,n)}),[s.x,s.y],{maxIterations:500,minErrorDelta:1e-10}).solution,x={x:h[0],y:h[1]},l=!0;for(t=0;t<r.length;++t)if(f(x,r[t])>r[t].radius){l=!1;break}for(t=0;t<n.length;++t)if(f(x,n[t])<n[t].radius){l=!1;break}if(!l)if(1==r.length)x={x:r[0].x,y:r[0].y};else{var y={};i(r,y),x=0===y.arcs.length?{x:0,y:-1e3,disjoint:!0}:1==y.arcs.length?{x:y.arcs[0].circle.x,y:y.arcs[0].circle.y}:n.length?j(r,[]):c(y.arcs.map((function(r){return r.p1})))}return x}function C(r,n){for(var t={},e=function(r){var n={},t=[];for(var e in r)t.push(e),n[e]=[];for(var a=0;a<t.length;a++)for(var i=r[t[a]],s=a+1;s<t.length;++s){var u=r[t[s]],o=f(i,u);o+u.radius<=i.radius+1e-10?n[t[s]].push(t[a]):o+i.radius<=u.radius+1e-10&&n[t[a]].push(t[s])}return n}(r),a=0;a<n.length;++a){for(var i=n[a].sets,s={},u={},o=0;o<i.length;++o){s[i[o]]=!0;for(var h=e[i[o]],x=0;x<h.length;++x)u[h[x]]=!0}var c=[],l=[];for(var y in r)y in s?c.push(r[y]):y in u||l.push(r[y]);var g=j(c,l);t[i]=g,g.disjoint&&n[a].size>0&&console.log("WARNING: area "+i+" not represented on screen")}return t}d3.layout.venn=function(){var r,n,a,s,u={sets:null,setsAccessor:function(r){return r.set||[]},setsSize:function(r){return r},packingStragegy:y,packingConfig:{value:function(r){return r.value}},size:[1,1],padding:0,layoutFunction:w,orientation:Math.PI/2,normalize:!0};function o(r){return arguments.length?(n=h(r),o):n}function h(n){var t,e,u,h=o.sets(),x=o.layoutFunction(),c=o.packingStragegy(),l=o.size(),y=l[0],g=l[1];for(var v in e=x(t=(h=function(r){var n,t,e,a,i=d3.map({},(function(r){return r.__key__})),s=d3.map(),u=o.setsAccessor(),f=o.setsSize(),h=r.length;for(a=-1;++a<h;)(n=u(r[a])).length&&(e=n.sort().join(","),n.forEach((function(r){(t=s.get(r))?t.size+=1:s.set(r,{__key__:r,size:1,sets:[r],nodes:[]})})),r[a].__setKey__=e,(t=i.get(e))?(t.size++,t.nodes.push(r[a])):i.set(e,{__key__:e,sets:n,size:1,nodes:[r[a]]}));return s.forEach((function(r,n){i.get(r)||i.set(r,n)})),i.forEach((function(r,n){n.size=f(n.size)})),o.sets(i),i}(n)).values()),console.info("data: ",n),console.info("sets: ",h),o.normalize()&&(e=q(e,o.orientation())),u=r,r=function(r,n,t,e){var a=[],i=[];for(var s in r)r.hasOwnProperty(s)&&(i.push(s),a.push(r[s]));n-=2*e,t-=2*e;for(var u=O(a),o=u.xRange,f=u.yRange,h=n/(o.max-o.min),x=t/(f.max-f.min),c=Math.min(x,h),l=(n-(o.max-o.min)*c)/2,y=(t-(f.max-f.min)*c)/2,g={},v=0;v<a.length;++v){var p=a[v];g[i[v]]={radius:c*p.radius,x:e+l+(p.x-o.min)*c,y:e+y+(p.y-f.min)*c}}return g}(e,y,g,o.padding()),u)r[v]&&(r[v].previous=u[v]);function p(n,t){for(var e,a=0,i=n.length;a<i;a++)if(f(e=r[n[a]],t)<e.radius)return!0;return!1}return u=null,s=C(r,t),h.forEach((function(n,t){t.d=function(n){return function(t){return function(r){var n={};i(r,n);var t=n.arcs;if(0===t.length)return"M 0 0";if(1==t.length){var e=t[0].circle;return function(r,n,t){var e=[];return e.push("\nM",r,n),e.push("\nm",-t,0),e.push("\na",t,t,0,1,0,2*t,0),e.push("\na",t,t,0,1,0,2*-t,0),e.join(" ")}(e.x,e.y,e.radius)}for(var a=["\nM",t[0].p2.x,t[0].p2.y],s=0;s<t.length;++s){var u=t[s],o=u.circle.radius,f=u.width>o;a.push("\nA",o,o,0,f?1:0,1,u.p1.x,u.p1.y)}return a.join(" ")}(n.sets.map((function(n){var e=r[n],a=e&&e.previous,i=e;return a||(a={x:y/2,y:g/2,radius:1}),i||(i={x:y/2,y:g/2,radius:1}),1==t&&e&&(e.previous=i),{x:a.x*(1-t)+i.x*t,y:a.y*(1-t)+i.y*t,radius:a.radius*(1-t)+i.radius*t}})))}}(t),t.center=s[n],t.innerRadius=function(n){var t,e,a,i,s,u=n.sets,o=n.center,h=1/0;for(t in r)e=r[t],i=u.indexOf(t)>-1,s=u.indexOf(t)<-1&&p(u,e),a=f(o,e),(a=i?e.radius-a:s?a-e.radius:a+e.radius)<h&&(h=a);return h}(t)})),a=c(o,n),n}return e(o,u),o.packingConfig=function(r){var n=u.packingConfig;if(!arguments.length)return n;for(var e in r)n[e]=r[e];return a&&t(a,r),o},o.packer=function(){return a},o.circles=function(){return r},o.centres=function(){return s},o.nodes=o,o},r.distribute=function(r){var n=r.circles();r.sets().forEach((function(r,t){var e=[],a=[],i=[],u=t.center,o=t.innerRadius;for(r in n)t.sets.indexOf(r)>-1?a.push(n[r]):i.push(n[r]);t.nodes.map((function(r,n){var t=0,f=null;if(0==n)r.x=u.x,r.y=u.y,e.push(r);else{for(;!f&&t<500;){n=Math.random()*e.length|0;var h=e[n],x=2*Math.PI*Math.random(),c=Math.sqrt(Math.random()*(o*o+100)),y={x:h.x+c*Math.cos(x),y:h.y+c*Math.sin(x)};t++,s(y,a)&&l(y,i)&&(f=y,e.push(y))}f||(console.warn("NO CANDIDATE"),f={x:u.x,y:u.y}),r.x=f.x,r.y=f.y}}))}))},r.force=function(r,n){var a=r.packer();a||e(a=d3.layout.force(),{padding:3,maxRadius:8,collider:!0,ticker:null,ender:null,starter:null});var i,s=r.packingConfig(),u=r.size(),o=r.sets(),f=a.padding(),h=a.maxRadius(),x=a.collider;return t(a,s).nodes(n).links([]).gravity(0).charge(0).size(u).on("start",(function(t){var e;n.forEach((function(r){var n=o.get(r.__setKey__).center;r.x=r.x?1*r.x:n.x,r.y=r.y?1*r.y:n.y})),(e=a.starter())&&e(r)})).on("tick",(function(t){var e;n.forEach(function(r){return function(n){var t=o.get(n.__setKey__).center;n.y+=(t.y-n.y)*r,n.x+=(t.x-n.x)*r}}(.2*t.alpha)),x&&n.forEach((i=.5,s=d3.geom.quadtree(n),function(r){var n=r.r+h+f,t=r.x-n,e=r.x+n,a=r.y-n,u=r.y+n;s.visit((function(n,s,o,h,x){if(n.point&&n.point!==r){var c=r.x-n.point.x,l=r.y-n.point.y,y=Math.sqrt(c*c+l*l),g=r.r+n.point.r+(r.__setKey__!==n.point.__setKey__)*f;y<g&&(y=(y-g)/y*i,r.x-=c*=y,r.y-=l*=y,n.point.x+=c,n.point.y+=l)}return s>e||h<t||o>u||x<a}))}));var i,s;(e=a.ticker())&&e(r)})),(i=a.ender())&&a.on("end",i),a},r.pack=y,Object.defineProperty(r,"__esModule",{value:!0})}));
